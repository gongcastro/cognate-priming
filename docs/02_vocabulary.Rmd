---
title: "Vocabulary"
output: github_document
always_allow_html: true
date: "`r paste0('Updated: ', format(Sys.Date(), '%d/%m/%Y'))`"
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = TRUE,
	warning = TRUE, 
	cache.extra = knitr::rand_seed,
	out.width = "80%",
	results = "asis",
	dpi = 300,
	dev.args = list(png = list(type = "cairo"))
)
options(
	knitr.kable.NA = '-',
	knitr.duplicate.label = "allow",
	ggplot2.discrete.fill = ggsci::pal_tron("legacy")(7),
	ggplot2.discrete.colour = ggsci::pal_tron("legacy")(7)
)


```


```{r params, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

# load objects
tar_load_globals()
tar_load(vocabulary)
tar_load(attrition)
tar_load(participants)

theme_set(theme_minimal()) # in utils.R

attrition <- attrition %>% 
	mutate(
		valid_gaze = valid_gaze_prime & valid_gaze_target,
		valid_status = case_when(
			!valid_vocab ~ "Invalid vocabulary",
			!valid_gaze ~ "Invalid gaze",
			!valid_participant ~ "Invalid participant",
			TRUE ~ "Valid"
		))


participants <- participants %>% 
	left_join(distinct(attrition, participant, age_group, valid_participant)) %>% 
	drop_na(participant) %>% 
	left_join(vocabulary) %>% 
	mutate(vocab_size_l1_center = scale(vocab_size_l1)[,1])
```


We collected vocabulary data from participants. In Oxford, participants were sent the online version of the Oxford Communicative Development Inventory [OCDI; @hamilton2000] two weeks before each appointment. In Barcelona, participants were sent the online vocabulary inventory [MultiLex](https://github.com/gongcastro/multilex) immediately after the appointment, and were given two weeks to fill it. In Oxford, families filled the vocabulary checklist in the testing language, and when the participant was monolingual, also in the second language. In Barcelona, all participants filled the Catalan and the Spanish versions of the vocabulary checklists. All checklists included the words involved in the trial lists. When filling the vocabulary checklist, families checked each word as being *understood*, *understood and produced* or *none*. Each response to either checklist was aggregated to produce several vocabulary measures:

* **Total vocabulary**: total number of words the child knows, summing up both languages. For instance, a child who knows 210 words in Catalan and 100 words in Spanish would have a total vocabulary size of 210 words.
* **L1 vocabulary**: number of words the child knows in the languages of higher exposure (i.e., testing language). For instance, for a child exposed to 75% Catalan who knows 210 words in Catalan and 100 words in Spanish, their L1 vocabulary size would be 210 words.
* **Conceptual vocabulary**: number of lexicalised concepts, that is, the number of concepts for which the child knows a word in at least one of the languages. For example, a Catalan-Spanish bilingual that knows *taula* and *mesa* -- Catalan and Spanish translations of *table*-- would have a conceptual vocabulary size of 1.

Vocabulary sizes of participants whose families failed to complete the vocabulary checklists were imputed, by assigning them the most likely vocabulary size from a distribution of vocabulary sizes of children of similar age ($\pm$ 1 month) and language profile (similar exposure to a second language, $\pm$ 10%) that completed the same vocabulary checklist previously.


# L1 vocabulary

This figure represents the vocabulary size in the dominant language of participants in the Y-axis and their linguistic profile in the X-axis. Results are presented separately for each age group. The shape of the violins, represents the distribution of the vocabulary sizes. The box-plot inside each violin represents the median, 25th and 75th percentiles, and the vertical lines represent the minimum and maximum values. vocabulary sizes in the dominant language were calculated as the proportion of items each participant was reported to *understand* or *understand and say* in the language of most exposure. for example, for a participant exposed mostly to Catalan, their vocabulary size in the dominant language was calculated as the proportion of words they were reported to understand and/or say in Catalan, from a total of ~200 words.

```{r vocabulary_l1, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.height=4}
sample_size <- participants %>% 
	filter(valid_participant, !is.na(vocab_size_l1)) %>% 
	count(age_group, location)

# vocabulary
participants %>% 
	drop_na(lp) %>%
	filter(valid_participant) %>% 
	ggplot() +
	facet_grid(location~age_group) +
	# geom_violin(
	# 	position = position_dodge(width = 0.75),
	# 	aes(lp, vocab_size_l1, colour = lp, fill = lp)
	# ) + 
	geom_hline(yintercept = 0.5, colour = "white") +
	geom_point(
		aes(lp, vocab_size_l1),
		shape = 1, colour = "white", size = 1, stroke = 1,
		position = position_jitter(width = 0.1, seed = 888)
	) +
	geom_boxplot(
		aes(lp, vocab_size_l1, colour = lp, fill = lp),
		width = 0.25, outlier.colour = NA, fill = "#0D1117",
		position = position_dodge(width = 0.75), size = 1
	) +
	geom_text(
		data = sample_size,
		aes(x = 1.5, y = 0.95, label = paste0("n = ", n)),
		colour = "white", fill = "white", show.legend = FALSE
	) +
	labs(y = "Receptive vocabulary (L1)", colour = "Group", fill = "Group") +
	scale_y_continuous(limits = c(0, 1), labels = percent) +
	theme(
		legend.title = element_blank(),
		legend.position = "none",
		panel.grid.major.y = element_blank(),
		axis.title.x = element_blank(),
		axis.text = element_text(size = 9)
	)

```


# Total vocabulary

```{r vocabulary_total, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.height=4}
sample_size <- participants %>% 
	filter(valid_participant, !is.na(vocab_size_l1)) %>% 
	count(age_group, location)

# vocabulary
participants %>% 
	left_join(distinct(attrition, participant, age_group, valid_participant)) %>% 
	drop_na(lp) %>%
	filter(valid_participant) %>% 
	ggplot() +
	facet_grid(location~age_group) +
	# geom_violin(
	# 	position = position_dodge(width = 0.75),
	# 	aes(lp, vocab_size_l1, colour = lp, fill = lp)
	# ) + 
	geom_hline(yintercept = 0.5, colour = "grey") +
	geom_point(
		aes(lp, vocab_size_total),
		shape = 1, colour = "white", size = 1, stroke = 1,
		position = position_jitter(width = 0.1, seed = 888)
	) +
	geom_boxplot(
		aes(lp, vocab_size_total, colour = lp, fill = lp),
		width = 0.25, fill = "#0D1117", outlier.colour = NA,
		position = position_dodge(width = 0.75), size = 1
	) +
	geom_text(
		data = sample_size,
		aes(x = 1.5, y = 0.95, label = paste0("n = ", n)),
		colour = "white", fill = "white", show.legend = FALSE
	) +
	labs(y = "Receptive vocabulary (L1+L2)", colour = "Group", fill = "Group") +
	scale_y_continuous(limits = c(0, 1), labels = percent) +
	theme(
		legend.title = element_blank(),
		legend.position = "none",
		panel.grid.major.x = element_blank(),
		axis.title.x = element_blank(),
		axis.text = element_text(size = 9),
		panel.grid.major.y = element_line(colour = "grey", linetype = "dotted")
	)

```


# Conceptual vocabulary


```{r vocabulary_conceptual, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.height=4}
sample_size <- participants %>% 
	filter(valid_participant, !is.na(vocab_size_l1)) %>% 
	count(age_group, location)

# vocabulary
participants %>% 
	left_join(distinct(attrition, participant, age_group, valid_participant)) %>% 
	drop_na(lp) %>%
	filter(valid_participant) %>% 
	ggplot() +
	facet_grid(location~age_group) +
	# geom_violin(
	# 	position = position_dodge(width = 0.75),
	# 	aes(lp, vocab_size_l1, colour = lp, fill = lp)
	# ) + 
	geom_hline(yintercept = 0.5, colour = "grey") +
	geom_point(
		aes(lp, vocab_size_conceptual),
		shape = 1, colour = "white", size = 1, stroke = 1,
		position = position_jitter(width = 0.1, seed = 888)
	) +
	geom_boxplot(
		aes(lp, vocab_size_conceptual, colour = lp, fill = lp),
		width = 0.25, fill = "#0D1117", outlier.colour = NA,
		position = position_dodge(width = 0.75), size = 1
	) +
	geom_text(
		data = sample_size,
		aes(x = 1.5, y = 0.95, label = paste0("n = ", n)),
		colour = "white", fill = "white", show.legend = FALSE
	) +
	labs(y = "Receptive vocabulary (coneptual)", colour = "Group", fill = "Group") +
	scale_y_continuous(limits = c(0, 1), labels = percent) +
	theme(
		legend.title = element_blank(),
		legend.position = "none",
		axis.title.x = element_blank(),
		axis.text = element_text(size = 9),
		panel.grid.major.x = element_blank()
	)

```
