```{r setup}
#| label: setup
#| echo: false
#| message: false
#| warning: false
# load objects
targets::tar_config_set(store = here::here("_targets"),
						script = here::here("_targets.R"))

targets::tar_load_globals()

targets::tar_load(
	c(participants,
	  stimuli,
	  vocabulary,
	  attrition_trials, 
	  attrition_participants,
	  bvq_data, 
	  gaze_aoi, 
	  data_related,
	  data_cognate,
	  data_time_related, 
	  data_time_cognate,
	))

targets::tar_load(
	c(model_fits_related,
	  model_fits_cognate,
	  # model_fits_related_time,
	  # model_fits_cognate_time,
	  # model_loo_related,
	  # model_loo_cognate,
	))


library(knitr)
library(kableExtra)
library(ggplot2)
library(gt)
library(patchwork)
library(english)
library(gtExtras)

# set ggplot theme and colour palette

my_theme <- theme_minimal() +
	theme(panel.grid = element_blank(),
		  axis.line = element_line(colour = "black"),
		  text = element_text(size = 12, colour = "black"),
		  axis.text = element_text(colour = "black"))

theme_set(my_theme)

clrs <- c("#003f5c", "#58508d", "#bc5090", "#ff6361", "#ffa600")

options(ggplot2.ordinal.fill = clrs[c(1, 4, 5)],
		ggplot2.ordinal.colour = clrs[c(1, 4, 5)],
		ggplot2.discrete.fill = clrs[c(1, 4, 5)],
		ggplot2.discrete.colour = clrs[c(1, 4, 5)],
		ggplot2.continuous.fill = ggplot2::scale_color_gradient,
		ggplot2.continuous.colour = ggplot2::scale_color_gradient)

set.seed(888)

# prepare data
attrition <- lst(participants,
				 attrition_participants,
				 attrition_trials) |> 
	reduce(inner_join, by = join_by(session_id)) |> 
	unnest_wider(matches("all"), names_sep = "_")

```


# Introduction

## The early lexicon


Bilingual infants receive a relative impoverished linguistic input in each of their languages compared to their monolingual peers. There is not reason to think bilinguals receive an increased amount of total linguistic input, so the fact that such input is divided between at least two languages means that they receive less input from each of their languages [@costa2014does]. The input bilinguals receive is also more complex than that of monolinguals. This is reflected in multiple dimensions. For instance, bilinguals are presented with two different, but possible overlapping phoneme inventories, they may be presented with two different grammatical systems, and often presented with more than one label per referent. This does not keep bilinguals from tuning their perceptual abilities to both phoneme inventories of their native languages, distinguishing grammatical irregularities in both languages, or learning more than one label per object. Bilinguals' developmental trajectories might not always be identical to monolinguals', but they achieve their language acquisition milestones at equivalent ages.

For instance, previous work on lexical acquisition has provided some insight into how bilinguals' vocabulary size is equivalent to monolingual's across ages, and the possible mechanisms behind this. @hoff2012 found that English-Spanish bilinguals' vocabulary in English was influenced by the words they had already acquired in Spanish. This is consistent with previous accounnts of lexical acquisition in which infants acquire new words through preferential acquisition [@hill2013, @fourtassi2020]. A monograph by @floccia2018introduction provided evidence of a language distance effect, where bilinguals learning two languiages sharing higher lexical similarity knew more words in their less dominant language than those learning two language with lower lexical similarity. Later work by @mitchell2022cognate and @garcia-castro@cognate provided evidence for a more direct facilitation effect of cognateness. Cognates are form-simlar translation equivalents. Cognateness is suggested to facilitate word acquisition through parallel activation: the co-activation of translation equivalents in speech might lead to an faster accumulation of learning instances with words, which ultimately results in an earlier age of acquisition.

It is well established that, across languages, monolingual infants start recognising their first word-forms before their first year of life [@jusczyk1999; @halle1994; @vihman2004], with the earliest age at which there is evidencer of familiar word recognition being 6 months [@bergelson2012]. Bilinguals start recognising words at similar ages. Using a Head-turn Prefernce Procedure and ERP registration,  @vihman2013 found English-Welsh bilinguals to be sensitive to the prevalence of auditorily presented words. Infants' looking times and ERP differed when presented with words frequently marked as "familiar" by caregivers of demogrtaphically equivalent peers (e.g., *nappy*, *thank you*, *bottle*, *apple*, and *naughty*), compared to when presented with rare words (e.g., *Eiffel*, *courtly*, *nettle*, *wacky*, and *juncture*).


Growing a mental lexicon is one of the main achievements in the developmental journey of infants. Being able to store lexical representations of familiar words allows infants to later recognise them in speech, and to retrieve their associated concepts. The first step towards spoken word-recognition is the acoustic-phonetic processing of the speech signal. This results in the activation of lexical representations whose associated phonological forms matches the acoustic signal to some extent. The activated word-forms then compete for selection: the lexical system uses the auditory input, together with top-down context provided by grammatical, supra-segmental, and semantic constraints, to select the candidate lexical representation with the best match. There is evidence that spoken word recognition occurs in a *cascaded* fashion. The activation and selection of candidate lexical representations overlap in time, relying on partial information that accumulates as the speech signal unfolds [@marslen1987functional; @marslen1978processing; @grosjean1980spoken]. This cascaded activation triggered by lexical access also results in the activation of the concepts associated to the accesses phonological forms. @allopenna1998tracking.

This is also the case in the developing lexicon. There is evidence that infants start forming their first lexical representations before their first year of life. Already at six months of age, infants show evidence of word recognition.  When presented with pairs of familiar objects and hearing the label of one of them, 6-months-old infants and older show a looking preference towards the named object [@bergelson20126; @bergelson2015early]. @chow2017spoken adapted the Visual World Paradigm from @huettig2007tug to explore 24- to 30-month-old toddlers' visual fixation patterns during a word recognition when presented with phonological and semantic distractors. In each trial, the authors presented participants with four semantically and phonologically pictures. Four seconds after pictures onset, a word-form was auditorily presented. The word did not refer to any of the pictures displayed on the screen, but was phonologically related to one of them (both labels shared phonological onset), and semantically related to another one of the pictures (both referents belonged to the same taxonomic category. For instance, participants might be presented with the pictures of a sandwich, a bus, a cat, and a dress. Then they would hear the carrier phrase "Look at the **bee**!". The authors registered participants fixations to the phonological and semantic distractors, and found evidence of a preference for the phonological distractor at earlier stages of the post-naming phase, and a preference for the semantic distractor at later stages of the trial. These results support a cascaded activation account of lexical access during the first stages of lexical development.

A critical property of bilingual language processing, both in adults and infants, is that of non-selective access to the lexicon. When listening to speech, bilinguals activate all lexical candidates from either language consistent with the speech signal. Even more surprising, when speaking, bilinguals activate all potential words consistent with the concepts they want to express.
This effect has been systematically reported in adults [@marian1999activation; @costa2000cognate; @thierry2007brain; @dunabeitia2009masked].

Also in toddlers [@von2012language; @von2014bilinguals] and school-aged children [@persici2019lexical; @bosma2020cognate]. Relatedly, some recent studies have investigated the recognition of mispronounced words comparing monolingual and bilingual toddlers. Overall, these studies do not find differences between monolinguals and bilinguals [@von2019impact; @wewalaarachchi2017vowels]. Evidence for differential processing of cognate and non-cognate words is provided by Ramon-Casas and colleagues who observed that SpanishCatalan 24-month-olds were more prone to accept mispronunciations when the stimuli involved cognate words than when they involved non-cognate words [@ramon2009vowel; @ramon2010non].

Although recent work has provided strong eviodence of parallel activation in early ages, how cognateness shapes that organisation of the early bilingual lexicon, and how this is reflected on the dynamics of lexical access during word comprehension and production is unclear.

Using the experimental paradigm developed by [@arias2009lexical; @arias2013s; @singh2014one] compared within and across language
priming effects in Chinese-English toddlers. @kuipers2015bilingualism compared ERP responses to picture-word pairs in English monolinguals and Welsh-English bilinguals where the words were either semantically related or unrelated to a pictured object. Although both studies tested 30-month-olds, the conclusions the authors reached do not fully agree. @singh2014one concluded that there is a discontinuity between adults and young children in the way the two lexicons interact, while @kuipers2010event and @kuipers2015bilingualism concluded that there are no differences in adults’ and toddlers’ lexical-semantic processing.

There is evidence of cascaded activation during lexical access. @chow2017spoken adapted the Visual World Paradigm from @huettig2007tug to explore 24- to 30-month-old toddlers' visual fixation patterns during a word recognition when presented with phonological and semantic distractors. In each trial, the authors presented participants with four semantically and phonologically pictures. Four seconds after pictures onset, a word-form was auditorily presented. The word did not refer to any of the pictures displayed on the screen, but was phonologically related to one of them (both labels shared phonological onset), and semantically related to another one of the pictures (both referents belonged to the same taxonomic category). For instance, participants might be presented with the pictures of a sandwich, a bus, a cat, and a dress. Then they would hear the carrier phrase "Look at the **bee**!". The authors registered participants fixations to the phonological and semantic distractors, and found evidence of a preference for the phonological distractor at earlier stages of the post-naming phase, and a preference for the semantic distractor at later stages of the trial. These results support a cascaded activation account of lexical access during the first stages of lexical development.

Evidence from cascaded activation in lexical access is also provided by bilinguals. The bilingual lexicon is language-non selective. There is strong evidence in support of bilinguals activating lexical representations from both languages during both speech production and comprehension. Previous studies on bilingual word production support a cascade account for lexical activation in which the phonology of non-selected lexical representations engages in excitatory or inhibitory dynamics in the lexical selection process.

Bilinguals' trajectories of word recognition  [@vihman2013]

@floccia2020translation tested 27-month-old simultaneous bilinguals in a cross-language priming paradigm. The two languages participants were learning were English, and an Additional Language (either Cantonese, Dutch, Fench, German, Greek, Italian, Mandarin, Polish, Portuguese, or Spanish). A prime word was embedded at the end of a carrier sentence that participants listened to. Then participants were presented with the auditory label of the target word, and two pictures were shown side-by-side, the target picture, and a distractor picture. In Study 1, the target word was the translation equivalent of the prime word (*cheese*-*fromage* for an English-French bilingual). In other trials, prime and target words were unrelated (e.g., *sock*-*fromage*). There was no phonological overlap at onset between prime and target or distractor labels in either of the two conditions. Participants were presented with two blocks of related and unrelated trials. In one of the blocks, participants were presented with English prime words and Home Language target words (*sock*-*fromage*), and in the other block they were presented with Additional Language prime words and English target words (*fromage*-*sock*). The authors found a cross-linguistic priming effect, in which participants showed a stronger preference for the target picture in the post-naming phase in related trials, as compared to unrelated trials. This effect was found regardless of the language of the prime (English or Home Language), or the dominance of the language of the prime (i.e., whether the prime word belonged to the dominant language). Target preference exceeded chance level in both conditions. In Study 2, the authors tested a similar group of bilinguals in a cross-linguistic semantic priing task, in which participants were primed with words in English, and tested with semantically related words in the Additional Language (or vive versa). This time, prime and target words were not translation equivalents, butr rather words whose referents shared semantic features. Results from Study  2 were parallel to those from Study 1. The authors found a strong semantic priming effect accross languages, regardless of the language of the prime or the dominance of the language of the prime. Overall these results suggest that bilinguals recognosed target words in both conditions, and benefitted from a cross-linguistic facilitation effect from translation equivalents. The symmetry of such effect across both languages suggests that participants lexical access ocurred in parallel for the two members of translation equivalents. As @floccia2020translation note, the stimuli set of Study 2 contains multiple cognates, especially in languiages with a larger degree of phonological overlap across translation pairs, like English and Dutch. The authors run *post hoc* analyses exploring the effect of cognateness on the cross-language priming effects found, which showed no evidence of a cognateness effect on target preference. However, the cross-language effects reported in Study 2 might still reflect the confounding influence of cognateness, as the resulting effect might have been generatd by an interaction by the phonological and semantic overlap between cognate primes and targets.

Another source of evidence supporting the language non-selective account of lexical access is provided by cross-languistic priming priuming thorught translation paradigms. In line with @floccia2020translation, @von2012language found that bilingual toddlers aged 21-to-43-months, and who were learning German and English, showed a stronger target preference in a German word recognition task after being primed with a phonologically related English word, which shared phonological onset with the prime word (e.g., *slide*-*Klide* [German for *dress*]), compared to when prime and target words were phonologically unrelated (e.g., *bottle*-*Ohr* [German for *ear*]). Interestingly, they also found evidence of such priming effect when participants were prime with an English word which was *not* phonologically related to the German target word, but rather its German translation was (e.g., *leg* [with German trasnlation *Bein*]-*Stein* [German for *stone*]). Altogether, these results indicate that bilingual toddlers activate translation equivalents in parallel during word recognition, and that the phonology of both labels may interact with lexical access in the recognition of subsequet words. Importantly, cross-linguitic priming through translation demonstrates that previous findings of a cognateness facilitation in word production and recognition do not result from the mere phonological overlap between auditorily presented and target labels, but also from the phonological overlap between the prime translation (not presented) and the target.

Evidence from cognates.
Marian and Spivey (1999)
Costa et al. (2000)

@dijkstra2019multilink

## Evidence from co-activation though translation
The role of cognates in lexical processing.


Another source of evidence are studies studies involving phonological priming of non-cognates through translation. [SEE REFERENCES FROM VON HOLZEN 2012]


## Implicit naming

The aforementioned studies use priming-though-translation paradigms. In these paradigms, cross-linguistic priming results from activation spreading from the lexical representation of the the (auditorily presented) prime word to the lexical representation of its translation through semantic associations (e.g., translation equivalence). When prime words are auditorily presented, the task design constraints the naming context to one of the languages. The consequence is a potential asymmtry between the activation dynamics of the lexical represetnation of both labels: while the participant has heard one label, the activation of its translation must spread across semantic links. This might lead to a lower strength, and higher lacenty of the activation of the translation.

##  How does language co-activation shape lexical development?

In the present study, we use an adaptation of an implicit naming paradigm by @mani2010infant, in which participants are primed with a picture, instead of an auditorily presented label. @mani2010infant showed that 18 month-old monolinguals implicitly generate the labels of name-known pictures presented in silence. In each trial, infants were presented with prime pictures presented in silence, and then with a target and a distractor picture, both presented side-by-side. Finally, the target picture's label was presented auditorily. The authors manipulated the phonological overlap between the prime label and the target label, so that in half of the trials both labels were phonologically related, sharing phonological onset (*cat*-*cup*), or phonologically unrelated (*ball*-*comb*). Prime and target-distractor pairs were semantically unrelated. Interestingly, infants showed a stronger looking preference for the target picture after phonologically related prime pictures, compared to after phonologically unrelated primes. This suggests that infants implicitly named prime pictures despite such pictures having been presented in silence, and that the phonology of the resulting label interacted with the subsequent auditory recognition of the target label. In particular, the authors found a facilitation effect: target looking preference was stronger in phonologically related primes, indicating that the activated phonological segments of the generated prime label facilitated the subsequent activation of the phonological representation of the target label during recognition.

@mani2011phonological used the same paradigm in 24-months-old monolinguals, and also found evidence of implicit naming, but in the opposite direction. After phonologically related primes, infants showed weaker target looking preference than after phonologically unrelated primes. These results interpreted these outcome as the result of the implicitly generated prime label interfering with the subsequent recognition of the (phonologically related) target word. The authors suggested that the shift from facilitation to interference from 18 to 24 months they found in both studies might be the result of a developmental shift in which 18-month-olds' lexicon is not yet organised based on phonological similarity, while 24-month-olds' is. This would lead to the former showing a pre-lexical facilitation effect in which such facilitation occurs via the activation of phonological segments, while the latter would show an interference effect due to lateral links between lexical representation having been established. Both studies by Mani and Plunkett provide evidence of implicit naming of name-known pictures by 18-month old toddlers and older, and that the resulting labels interact with the dynamics of recognition of subsequently presented word-forms.

Even earlier evidence of implicit naming was provided through ERP registering at 14 months of age. @duta2012erp presented name-known pictures in silence for one second. After one second, the picture's label was presented auditorily, and the infants' N400 component was registered. In some trials the auditory label corresponded to a canonical realisation of the word-form. In other trials, the word was mispronounced. Infants ERP signal differed when presented with correct pronunciations or mispronunciations, indicating that infants had generated expectations at the phonological level about the auditory labels of the picture before they were presented with its auditory label. A later study by @styles2015infant re-analysed the first 1,000 ms of the trials in the previous study (while the picture was being presented before the auditory label was presented), and found that the ERPs of name-known pictures (according to parental reports of receptive vocabulary) differed from those of name-unknown pictures (which infants would not be able to lexicalise). This provides further support to the account that at around 14 months of age, infants already name familiar pictures, even if presented in silence.

When extended to the bilingual case, this implicit naming task may offer bilingual participants with an uncontrained naming context in whcih the activation of both labels may occur in a truly cascaded fashion for both languages in parallel: the recognition of the prime object depicted activates the (common) semantic representation for both members of the translation equivalent, and this in turn activates the two available phonological word-forms, one in each language. Using an adaptation of @mani2010infant's implicit naming paradigm, @von2014bilinguals provided evidence that bilingual adults generate implicit labels in both labels for visually fixated pictures. The authors presented German-English bilinguals with 120 prime-target pairs. Primes were presented as familiar pictures in silence. After prime picture offset, target words were presented auditorily. Participants' N400 ERP components were recorded from target word onset. The authors manipulated the phonological relationship between the prime and target word-forms within participants' L1 and across L1 and L2. When prime and target were phonologically identical (*Affe*-*Affe*, German for *monkey*), or similar (*Fahne*-*Sahne*, German for *flag* and *ice-cream*, respectively) within L1, participants' showed a reduced N400 amplitude, compared to when prime and target were phonologically unrelated (*Messer*-*Seil*, German for *knife* and *rope*). Critically, a similar effect was found when prime and target were phonologically related through translation (*Rustsche*-*Kleid*, German for *slide* and *dress*). This suggests that participants activated prime labels in both languages in parallel, and that both labels impacted the dynamics of target words recognition.

Evidence from cognates.



The role of cognates in lexical processing.


This study also provides a more suitable design for drawing conslusions about developmental change in word recognition trajectories frot wo reasons. First, it extends the age range of participants, compared to previous studies. Second, participants were tested at three selected age points to ensure a more balanced sample size across ages. Third, the partially longitudinal design allows modelling the performance of participants across testing sessions altogether.

. In order to circumvent the problem of limited vocabulary knowledge
in the non-dominant language, we propose to test participants only in their dominant language, therefore
directing our research to the question of how possessing a second language affects processing of the
dominant one in bilingual toddlers [@costa2014does provide a fuller description of the
advantages of such approach].

## The present study

The present study is aimed at investigating the developmental trajectories of word recognition in bilingualism, and how (if at all) language non-selectivity shapes them. Using an adaptation of [@mani2010infants], we presented 20- to 32-months-old toddlers with a cross-linguistic phonological priming paradigm. We manipulated both the phonological overlap between the prime word and target word, and the cognate status of the prime word, to test the hypothesis that bilingual toddlers implicitly name familiar pictures in both languages. If so, phonological priming effect should be larger when the prime label in  both languages shares phonological overlap with the target words (cognate condition), compared to when only the label of the prime in one language overlaps phonologically with the target (non-cognate condition). We also also included a control *Unrelated* condition in which regardless of the cognate status of the prime word, neither of the prime labels in any language overlapped phonologically with the target word.

# Methods

All materials, data, and reproducible code can be found at the OSF ([https://osf.io/hy984/](https://osf.io/ckydb/)) and GitHub ([https://github.com/gongcastro/cognate-priming](https://github.com/gongcastro/cognate-priming)) repositories. This study was conducted according to guidelines laid down in the Declaration of Helsinki, and was approved by the Drug Research Ethical Committee (CEIm) of the IMIM Parc de Salut Mar, reference 2020/9080/I. Before every testing session, caregivers were asked to read and sign an informed consent form, and were given a token of appreciation at the end of it.

## Participants

```{r}
#| label: participants-numbers
n_participants_total <- participants |> 
	distinct(location, child_id) |> 
	count(location)

n_participants_sex <- participants |> 
	distinct(location, sex, child_id) |> 
	count(location, sex)

n_participants_sessions <- count(participants,
								 child_id,
								 name = "n_sessions") |> 
	count(n_sessions) |> 
	group_split(n_sessions) |> 
	set_names(paste0("session_", 1:3))

n_sessions_total <- count(participants)

n_sessions_lp <- participants |> 
	summarise(across(age, lst(mean, sd, min, max)),
			  n = n(),
			  .by = c(lp)) |> 
	mutate(across(age_mean:age_max, \(x) round(x, 2))) |> 
	group_split(lp) |> 
	set_names(janitor::make_clean_names(unique(participants$lp)))

n_sessions_dominance_lp <- count(participants, lp, test_language) |> 
	group_split(test_language) |> 
	set_names(c("catalan", "english", "spanish")) |> 
	map(group_split, lp)

n_sessions_lp <- participants |> 
	count(lp) |> 
	group_split(lp) |> 
	set_names(c("monolingual_eng", "monolingual", "bilingual"))
```

We collected data from `r n_participants_total$n[1]` participants living in the Metropolitan Area of Barcelona (Spain) tested at the Laboratori de recerca en Infància at the Universitat Pompeu Fabra (`r n_participants_sex$n[1]` female, `n_participants_sex$n[2]` male), and `r n_participants_total$n[2]` participants living in the Oxfordshire area (United Kingdom), tested at the Oxford BabyLab at the University of Oxford (`r n_participants_sex$n[3]` female, `n_participants_sex$n[4]`, `n_participants_sex$n[5]` not reported). Families were recruited from maternity room in private hospitals or from social media, and contacted via phone when the child's age spanned between 20 and 32 months. From the `r sum(n_participants_total$n)` children that participated, `r n_participants_sessions$session_1$n` participated once, `r n_participants_sessions$session_2$n` participated twice, and `r n_participants_sessions$session_3$n` participated three times. Recurrent participants were tested with at least XXX months of difference. We gathered a total of `r n_sessions_total$n` testing sessions: `r n_sessions_lp$monolingual_english$n` from participants in Oxford, and `r n_sessions_lp$monolingual$n + n_sessions_lp$bilingual$n` from participants in Barcelona.

We assessed participants' language profile using the Language Exposure Questionnaire [LEQ, @bosch2001evidence]. Before each experimental session, the experimenter asked the caretakers to estimate the amount of hours per day they and other people in the infant's social circle have spent speaking to the infant in any language since birth. The output of this interview is an estimated degree of exposure (*DoE*) to each language, indicated by the proportion of time the infant was reported to have listened to each language. According to this estimate, we classified participants as Catalan-, English-, or Spanish-dominant if the language with highest *DoE* was Catalan, English, or Spanish, respectively, and tested the participant in the stimuli set that contained words in their native language. From the `r n_sessions_total$n` testing sessions, `r n_sessions_lp$monolingual_english$n` belonged to English monolinguals,  `r n_sessions_lp$monolingual$n` to Catalan or Spanish monolinguals, and  `r n_sessions_lp$bilingual$n` to Catalan-Spanish bilinguals. @tbl-participants shows a detailed description of the linguistic profile of our sample.


```{r tbl-participants}
#| label: tbl-partiicpants
#| tbl-cap: "Demographic and linguistic profile of participants."
participants |> 
	unnest_wider(doe) |> 
	select(-matches("others")) |> 
	mutate(lp = case_when(
		lp=="Monolingual" ~ "Monolingual (Catalan or Spanish)",
		lp=="Bilingual" ~ "Bilingual (Catalan-Spanish)",
		.default = lp)) |> 
	arrange(desc(lp)) |> 
	summarise(n = n(),
			  across(age, lst(mean, sd, min, max)),
			  across(matches("doe_"), lst(mean, sd)),
			  age_vctr = list(age),
			  .by = c(lp, test_language)) |> 
	gt(rowname_col = "test_language",
	   groupname_col = "lp") |> 
	gt_plt_dist(age_vctr, type = "histogram") |> 
	fmt_number(is.numeric, decimals = 1) |> 
	fmt_integer(n) |> 
	fmt_number(matches("doe"), decimals = 1, scale_by = 100) |> 
	cols_merge_range(age_min, age_max) |> 
	cols_merge_uncert(age_mean, age_sd) |> 
	cols_merge_uncert(doe_catalan_mean, doe_catalan_sd) |> 
	cols_merge_uncert(doe_english_mean, doe_english_sd) |> 
	cols_merge_uncert(doe_spanish_mean, doe_spanish_sd) |> 
	tab_spanner("Age (months)", matches("age")) |> 
	tab_spanner("Catalan", matches("catalan")) |> 
	tab_spanner("English", matches("english")) |> 
	tab_spanner("Spanish", matches("spanish")) |> 
	tab_spanner("Degree of Exposure (%)", matches("doe")) |> 
	cols_label(n = "N",
			   age_mean = "M (SD)",
			   age_min = "Range",
			   age_vctr = "Distribution",
			   doe_catalan_mean = "M (SD)",
			   doe_english_mean = "M (SD)",
			   doe_spanish_mean = "M (SD)") |> 
	tab_style(cell_text(style = "italic"),
			  cells_column_labels()) |> 
	tab_style(cell_text(weight = "bold"),
			  cells_column_spanners())
```

We collected data from `r n_participants_total` monolingual and bilingual participants living in the Metropolitan Area of Barcelona (Spain), who were exposed to at least Catalan and/or Spanish from birth. Families were recruited from maternity room in private hospitals in Barcelona, and contacted via phone when the child's age spanned between our age intervals of interest. Families were invited to participate at three age points: 21, 25, and 30 months. `r n_participants_sessions[[1]]$n` participants were tested at one age point,  `r n_participants_sessions[[2]]$n` at two age points, and `r n_participants_sessions[[3]]$n` at the three age points. In total, we gathered data from `r n_sessions_total$n` testing sessions: `r n_sessions_age_group$age_21$n` at 21 months (*Mean* = `r round(n_sessions_age_group$age_21$age_mean, 2)`, *SD* = `r round(n_sessions_age_group$age_21$age_sd, 2)`, *Range* = `r n_sessions_age_group$age_21$age_min`--`r n_sessions_age_group$age_21$age_max`), `r n_sessions_age_group$age_25$n` at 25 months (*Mean* = `r round(n_sessions_age_group$age_25$age_mean, 2)`, *SD* = `r round(n_sessions_age_group$age_25$age_sd, 2)`, *Range* = `r n_sessions_age_group$age_25$age_min`--`r n_sessions_age_group$age_25$age_max`), and `r n_sessions_age_group$age_30$n` at 30 months (*Mean* = `r round(n_sessions_age_group$age_30$age_mean, 2)`, *SD* = `r round(n_sessions_age_group$age_25$age_sd, 2)`, *Range* = `r n_sessions_age_group$age_30$age_min`--`r n_sessions_age_group$age_30$age_max`). 

Participants' vision was normal, none used glasses or any other type of vision corrector.

### Language profile {#sec-lp}

We assessed participants' language profile using the Language Exposure Questionnaire [LEQ, @bosch2001evidence]. Before each experimental session, the experimenter asked the caretakers to estimate the amount of hours per day they and other people in the infant's social circle have spent speaking to the infant in any language since birth. The output of this interview is an estimated degree of exposure (DoE) to each language, indicated by the proportion of time the infant was reported to have listened to each language. According to this estimate, we classified participants as Catalan- or Spanish-dominant if the language with highest DoE was Catalan or Spanish, respectively, and tested the participant in the stimuli set that contained words in their native language. We collected data from `r n_sessions_dominance$catalan$n` Catalan-dominant participants in Catalan (`r n_sessions_dominance_age_group$catalan$age_21$n` at 21 months, `r n_sessions_dominance_age_group$catalan$age_25$n` at 25 months, and `r n_sessions_dominance_age_group$catalan$age_30$n` at 30 months). We further classified participants as monolinguals if the DoE to their dominant language exceeded 80% of the total DoE to Catalan and Spanish, and as bilinguals otherwise. Participants with DoE to language other than Catalan or Spanish were excluded from analyses. This divided the sample into `r n_sessions_lp$monolingual$n` monolinguals (`r n_sessions_lp_age_group$monolinguals$age_21` at 21 months, `r n_sessions_lp_age_group$monolinguals$age_25` at 25 months, and `r n_sessions_lp_age_group$monolinguals$age_30` at 30 months), and `r n_sessions_lp$bilingual$n` bilinguals (`r n_sessions_lp_age_group$monolinguals$age_21` at 21 months, `r n_sessions_lp_age_group$bilingual$age_25` at 25 months, and `r n_sessions_lp_age_group$bilingual$age_30` at 30 months). @tbl-participants-lp shows a detailed description of the linguistic profile of our sample.

### Vocabulary size

```{r vocab-values}
n_imputed <- table(vocabulary$is_imputed)[2]
prop_imputed <- scales::percent(n_imputed/nrow(vocabulary))
n_pool <- nrow(bvq_data$vocabulary)
```

We collected vocabulary data using parental responses to the Barcelona Vocabulary Inventory [BVQ, @garcia-castro2023bvq], an online vocabulary checklist inspired in several adaptations of the the Communicative Developmental Inventory [CDI, @fenson1994variability] developed to assess the vocabulary size of Catalan-Spanish bilingual toddlers. Families received a link to the BVQ immediately after each experimental session, and were given two weeks to fill it.

We calculated several measures of receptive vocabulary size from each participant's vocabulary: L1 vocabulary size (proportion of words  reported as acquired in the checklist of the dominant language), L2 vocabulary size (proportion of words  reported as acquired in the checklist of the non-dominant language), total vocabulary size (proportion of the words in both checklists reported as acquired), conceptual vocabulary (proportion of concepts for which the participant was reported to have acquired at least one label, in any language), and translation equivalent vocabulary (proportion of concepts for which the participant was reported to have acquired at two labels, one in each language).


`r n_imputed` (`r prop_imputed`) Families failed to provide a complete response to the BVQ within the two-week time limit, or did not provide a successful response to the questionnaire. For missing questionnaire responses, we imputed the vocabulary size of the participant using single imputation, using the vocabulary size scores of a pool of `r n_pool` additional participants for which a successful response for the questionnaire had been gathered. We used participants age in months and their language profile (monolingual/bilingual) as predictors. We used the `mice` R package [@van2011mice] to perform imputation using the Bayesian linear regression method. 

```{r tbl-vocabulary}
#| label: tbl-vocabulary
#| tbl-cap: "Participant vocabulary sizes across ages and language profiles. Vocabulary size scores are presented using two measures: L1 vocabulary size (proportion of words marked as *Understands* in the vocabulary checklist of the dominant language), and total vocabulary size (proportion of words marked as *Understands* in vocabulary checklists of both dominant and non-dominant languages). Vocabulary size scores from the recurrent participants are shown linked."
#| eval: false
vocabulary |> 
	inner_join(select(participants, child_id, session_id, age, lp),
			   by = join_by(child_id, session_id)) |> 
	pivot_longer(c(total_prop, l1_prop),
				 names_to = "measure",
				 values_to = "prop",
				 names_transform = \(x) gsub("_prop", "", x)) |> 
	mutate(lp = case_when(
		lp=="Monolingual" ~ "Monolingual (Catalan or Spanish)",
		lp=="Bilingual" ~ "Bilingual (Catalan-Spanish)",
		.default = lp) |> 
			factor(levels = c("Monolingual (English)",
							  "Monolingual (Catalan or Spanish)",
							  "Bilingual (Catalan-Spanish)")),
		measure = if_else(measure=="l1", 
						  "L1 vocabulary", 
						  "Total vocabulary"),
		is_imputed = if_else(is_imputed, "Imputed", "Observed") |> 
			factor(levels = c("Observed", "Imputed"))) |> 
	ggplot(aes(age, prop, colour = is_imputed)) +
	facet_grid(measure ~ lp) +
	geom_line(aes(group = child_id),
			  alpha = 1/2,
			  colour = "grey") +
	geom_point() +
	labs(x = "Age (months)",
		 y = "Vocabulary size (%)") +
	theme(panel.grid = element_line(linetype = "dotted",
									colour = "grey"),
		  legend.position = "right",
		  legend.title = element_blank())
```


## Stimuli

```{r stimuli-values}
n_words <- length(unique(with(stimuli, unlist(prime, target, distractor))))
```

We used `r n_words` distinct words included in the BVQ to create the stimuli lists. We created six stimuli lists: three in Catalan, and three in Spanish. Each list contained 32 trials, each involving a prime-target-distractor group. Each word played a role as either prime, *or* as target and distractor across the three lists in their corresponding language. For instance, the Catalan word *cadira* appeared as *prime* in the three lists, but never as *target* or *distractor*; the Catalan word *bici* appeared as *target* and *distractor* across the three lists, but never as a prime. Target-distractor pairings were held constant across the three lists in each language. For instance, in all Catalan lists the word *bici* was paired with the word *porta*. Target-distractor pairings were also yoked, so that each member of the same target-distractor pair appeared once as target and once as distractor in each list. For instance, the *bici*-*porta* paired appeared twice in each of the three Catalan lists: once with *bici* as target and *porta* as distractor, and once with *porta* as target and *bici* as distractor. This counterbalancing avoided participants encountering looking at the target word guided solely by that word having being named in a previous trial. Finally, prime words appeared only once in each list: each target-distractor pair was associated with a different prime word in both appearances. In each list, the same prime word was presented alongside a different target-distractor pair. For instance, the Catalan prime word *barret* was presented with the *bici*-*porta* target-distractor pair in one list, with the *bici*-*porta* pair in another list, and with *berenar*-*amanida* in the remaining list. The order of the trials was randomised across experimental session, so that each time a participant was tested, the order in which the prime-target-distractor was presented was randomised. Each participant was randomly assigned to one of the three lists in the corresponding language (their dominant language, see @sec-lp), and always the same list across their experimental sessions in the case of a recurrent participant.

In 16 of the 32 trials of the same list (henceforth *related* trials), the prime and the target words were phonologically related, sharing phonological onset (at least first phoneme). In the other 16 trials (*unrelated* trials), prime and target did not share phonological onset. 8 of the 16 *related* trials included a cognate prime (*cognate* trials), and the other 8 included a non-cognate trials (*non-cognate* trials). A prime word was considered cognate if its Catalan and Spanish translation shared phonological onset. Especial attention was paid to avoiding semantic or taxonomic relationships between prime and target words, and between prime and distractor words. Target and distractor word pairs were phonologically unrelated (did not share phonological onset). Some of them shared semantic features or a taxonomic relationship. This is the case of words associated with especially salient referents such as animals or food. To avoid infants guiding their gaze to these objects based on their saliency, we paired animals and food items together. The position of the target and distractor pictures (right or left) for each target-distractor pair was alternated, so that in one list the target would appear on the left, in another list it would appear on the right, and so on.

We examined the overall equivalence of the three trial types by comparing them across three variables relating to the target word: lexical frequency, word prevalence, animacy
@tbl-stimuli shows a detailed summary of the stimuli properties, broken down by trial type and testing language. Lexical frequencies were extracted from the Catalan and Spanish corpora of the CHILDES database [@reference; @reference] as counts per million words, and transformed into Zipf scores for easier cross-language comparison [@reference; @reference]. We defined word prevalence as the proportion of same-aged infants who were reported to understand the word in the BVQ database.


### Auditory stimuli

The auditory stimuli were natural exemplars of the selected target words, spoken by Catalan-Spanish proficient bilingual female speaker who was instructed to pronounce each word in a toddler-directed manner. Recordings were made with an Audio-Tecnica 328 microphone (AT2050) at a sampling rate of 44100 Hz, in a soundproof room at the *Laboratori de Recerca en Infancia* at University Pompeu Fabra. We used the Audacity [@reference] and Praat [@boersma2001speak] to record and edit the audio files. The speaker was presented with a list of words in Catalan. The order of the words was pseudo-randomised, and each word was produced three times in a row before moving to the next word in the list. After going through all the words in the list, the speaker went through the word list again generating three tokens for each word, now in an inverse order (from bottom of the list to the top). We then repeated the same procedure for the list of Spanish words. The resulting audios were manually chunked into individual word-forms. For each of the six tokens produced for each word, the most adequate was selected for further processing. The audios were then transformed to stereo by duplicating them into two channels, denoised, and finally normalised. The mean duration of the final audios was `r round(mean(stimuli$duration[stimuli$test_language=="Catalan"]), 2)` (*SD* = `r round(sd(stimuli$duration[stimuli$test_language=="Catalan"]), 2)`) and `r round(mean(stimuli$duration[stimuli$test_language=="Spanish"]), 2)` (*SD* = `r round(sd(stimuli$duration[stimuli$test_language=="Spanish"]), 2)`) seconds for the Catalan and Spanish lists.

To make the pronunciation of the words as familiar as possible to each infant, we generated additional pronunciation variants for some words in Catalan and Spanish. Catalan words involving the /\textipa{L}/ phoneme in their Central Catalan variant (e.g., /\textipa{'Lu.n@}) were also recorded with such phoneme replaced by /j/ (e.g., /\textipa{'ju.n@}), a phonological process common in the Metropolitan Area of Barcelona [@reference]. Spanish words involving the /\textipa{T}/ phoneme were also generated replacing such phoneme with /\textipa{s}/ to better accommodate Latin variants of Spanish. Before every experimental session, caregivers were asked to utter three written words involving the /\textipa{L}/ phoneme (in the case of participants tested in Catalan) or the /\textipa{T}/ phoneme (in the case of participants tested in Spanish). Each token contained the critical phoneme at onset, inter-vocalic position, and coda. The experimenter assigned the participant to the Catalan or Spanish stimuli list involving the closest variant to that of caregivers'.


### Visual stimuli

For each word, we created a picture with a typical referent. To avoid competition between target and distractor pictures, semantically related target-distractor pairs were perceptually distinct [@floccia2020translation; @arias-trejo2010].

```{r tbl-stimuli}
#| label: tbl-stimuli
#| tbl-cap: "Summary of stimuli properties by trial type."
stimuli |> 
	summarise(across(c(matches("familiarity_|freq_|animate_"), duration),
					 tibble::lst(mean, sd, min, max)),
			  .by = c(test_language, trial_type)) |> 
	select(-matches("familiarity_se"), -matches("prime"),
		   -c(is_animate_target_sd,
		      is_animate_target_min,
		      is_animate_target_max),
		   -matches("min"), -matches("max")) |> 
	gt(groupname_col = "test_language",
	   rowname_col = "list") |> 
	fmt_number(is.numeric,
			   decimals = 1) |> 
	fmt_number(matches("familiarity|animate"),
			   scale_by = 100,
			   decimals = 1) |> 
	cols_merge(c(freq_target_mean, freq_target_sd),
			   pattern = "{1} ({2})") |> 
	cols_merge(c(familiarity_target_mean, familiarity_target_sd),
			   pattern = "{1} ({2})") |> 
	cols_merge(c(duration_mean, duration_sd),
			   pattern = "{1} ({2})") |> 
	cols_label(trial_type = "",
			   familiarity_target_mean = "Prevalence (%)",
			   freq_target_mean = "Frequency",
			   is_animate_target_mean = "Animacy (%)",
			   duration_mean = "Duration (s)") 
```


## Procedure

Testing took place in a sound-proof room. Participants sat on their caregivers' lap in a dimly lit testing booth while the experimenter conducted the experiment from outside. Caregivers were instructed to keep their eyes shut (to avoid recording their gaze, instead of the participant's), to be still, and to avoid interacting with the participant verbally or non-verbally. Participants sat at approximately 65 cm from the eye-tracker and a XX-in screen of $1929\times1080$ screen resolution. We used a custom Matlab XXXX script using the PsychToolbox XXX extension [@brainard] to present the stimuli, and the Tobii Analytics SDK 3.0 to interact with the eye-tracking while the experiment was running. Sampling rate was set at 120 Hz. A 5-point calibration was performed before every experimental session, in which the picture of a colourful beach ball was presented. We set a 55% grey background for the calibration and stimuli presentation. Auditory stimuli were presented through two loudspeakers located behind the screen, one to each side. The experimenter monitored the experimental from outside the room using a centrally located video camera place above the screen. After a successful calibration the experimenter triggered the onset of the first trial. Trials were presented uninterruptedly and  without intervention of the experimenter until the 32 trials were presented, or the experimental session had to be stopped because of the participant's behaviour.

![Experimental task design with examples in Catalan. In each trial, the prime image is presented in silence for 3,000 ms. The the auditory target label is presented, and finally the target and distractor pictures are presented side-by-side for 2,000 ms. In cognate trials (*n* = 8), Catalan *and* Spanish prime labels shared phonological onset with the target label. In non-cognate trials (*n* = 8), only the Catalan prime label shared phonological onset with the target label. In unrelated trials (*n* = 32), none of the prime labels shared phonological onset with the target label.](_assets/img/design.png){fig-align="center"}

Each trial started with the presentation of an attention getter for 3,000 milliseconds. Then, the prime picture was presented in silence in the centre of the screen for 1,500 milliseconds. Fifty milliseconds after the offset of the prime image, an auditory label was played from the loudspeakers and, 700 milliseconds after the onset of the auditory label, the target and distractor pictures were presented side-by-side during 1,000 milliseconds until the end of the trial. After this, the attention getter of the next trial was immediately presented. Each experimental session took approximately 10 minutes.

## Apparatus

see https://link.springer.com/article/10.3758/s13428-021-01762-8

## Data processing

```{r dataset}
n_trials <- nrow(attrition)
n_sessions <- n_distinct(attrition$session_id)
n_participants <- n_distinct(attrition$child_id)
n_trials_valid <- nrow(filter(attrition,
							  is_valid_participant,
							  is_valid_trial))
n_sessions_valid <- sum(attrition_participants$is_valid_participant)
n_participants_valid <- n_distinct(
	attrition[attrition$is_valid_participant, ]$child_id)

n_exc_prime <- sum(!attrition$is_valid_gaze_all_prime)
n_exc_test <- sum(!attrition$is_valid_gaze_all_test)
n_exc_test_each <- sum(!attrition$is_valid_gaze_all_test_each)
n_exc_vocab <- sum(!attrition$is_valid_vocab)
n_exc_participants <- sum(!attrition_participants$is_valid_participant) 

n_longitudinal <- attrition |>
	filter(is_valid_participant,
		   is_valid_trial) |>
	distinct(child_id, session_n) |> 
	count(child_id, name = "times") |> 
	count(times)
```

Missing eye-tracker samples were interpolated using the last-observation-carried-forward [see @zettersten2022peekbank for a similar approach], with a maximum of 20 maximum consecutive missing samples being interpolated (an equivalent of 166.67 ms).

We gathered data from `r format(n_trials, big.mark = ",")` trials from `r n_sessions` testing sessions, generated from `r n_participants` distinct participants. We excluded trials in which participants failed to provide 50%  valid eye-tracking samples (equivalent to 750 ms) during the prime phase (*n* = `r format(n_exc_prime, big.mark = ",")`) or 50% valid samples (equivalent to 1,000 ms) during the target-distractor phase (*n* = `r format(n_exc_test, big.mark = ",")`). We also excluded trials in which participants did not provide at least 5% of valid samples (equivalent to 100 ms) of target-looking *and* distractor looking in the test phase (*n* = `r format(n_exc_test_each, big.mark = ",")`) [see @floccia2020translation for a similar approach]. Finally, we excluded trials in which participants did not understand the prime *or* the target word, according to a supplementary vocabulary checklist filled by their caregivers upon experiment completion (*n* = `r format(n_exc_vocab, big.mark = ",")`). After trials that matched any of the aforementioned exclusion criteria from the dataset, we excluded participants who did not provide at least two valid trials in the *Cognate* condition, the *Non-cognate* condition, or the  *Unrelated* condition (*n* = `r n_exc_participants`). The final dataset included `r format(n_trials_valid, big.mark = ",")` trials from `r n_sessions_valid` testing sessions, generated by `r format(n_participants_valid, big.mark = ",")` distinct participants. Of those participants, `r n_longitudinal[1, 2]` provided data from one experimental session, `r n_longitudinal[2, 2]` provided data from two experimental sessions, and `r n_longitudinal[3, 2]` provided data from three experimental sessions. @tbl-attrition-trials shows a detailed description of the trial attrition.


```{r tbl-attrition}
#| label: tbl-attrition
#| tbl-cap: "Participant-level and trial-level sample size after applying inclusion criteria. The number of excluded participants and trials is indicated between parentheses."
expanded <- expand(attrition, lp, trial_type, is_valid_trial)

n_lp <- attrition |> 
	distinct(is_valid_participant, lp, session_id) |> 
	count(is_valid_participant, lp) |> 
	pivot_wider(names_from = is_valid_participant,
				values_from = n,
				names_repair = janitor::make_clean_names) |> 
	mutate(n_participants_true = true,
		   n_participants_false = false) |> 
	select(lp, true, false)

attrition |> 
	summarise(n_trials_true = sum(is_valid_trial),
			  n_trials_false = sum(!is_valid_trial),
			  .by = c(lp, trial_type)) |> 
	arrange(desc(lp)) |> 
	# across(n_trials, lst(mean, sd, sum), na.rm = TRUE),
	
	pivot_wider(id_cols = lp,
				names_from = c(trial_type),
				values_from = matches("trials"),
				names_repair = janitor::make_clean_names) |> 
	left_join(n_lp, by = join_by(lp)) |> 
	mutate(lp = case_when(
		lp=="Monolingual" ~ "Monolingual (Catalan or Spanish)",
		lp=="Bilingual" ~ "Bilingual (Catalan-Spanish)",
		.default = lp)) |>
	select(lp, true, false,
		   matches("n_trials")) |> 
	gt(rowname_col = "lp") |> 
	tab_spanner("Participants", matches("participant")) |> 
	tab_spanner("Trials", matches("trial")) |> 
	fmt_integer(everything()) |> 
	cols_merge(c(true, false),
			   pattern = "{1} ({2})") |> 
	cols_merge(c(n_trials_true_cognate,
				 n_trials_false_cognate),
				 pattern = "{1} ({2})") |> 
	cols_merge(c(n_trials_true_non_cognate,
				 n_trials_false_non_cognate),
				 pattern = "{1} ({2})") |> 
	cols_merge(c(n_trials_true_unrelated, 
				 n_trials_false_unrelated),
				 pattern = "{1} ({2})") |> 
	cols_label(true = "N", 
			   n_trials_true_cognate = "Cognate",
			   n_trials_true_non_cognate = "Non-cognate",
			   n_trials_true_unrelated = "Unrelated") |> 
	tab_style(cell_text(style = "italic"),
			  cells_column_labels()) |>
	grand_summary_rows(fns = list(label = md("*N*")) ~ sum(.),
					   fmt = ~ fmt_integer(.))
```



## Data analysis

We conducted two main analyses. In the first analysis, we estimated the effect of phonological priming on participants' target looking comparing *related* trials---in which prime and target share phonological onset, and the prime was not a cognate word---with *unrelated* trials---in which prime and target did not share phonological onset, and neither was the prime a cognate word, leaving out *cognate* trials. This analysis included all trials on the data set. Second, we estimated the effect of cognateness on phonological priming, comparing *cognate* trials---in which prime and target shared phonological onset, and the prime was a cognate word that also shared phonological onset with the target, with *non-cognate* trials---in which prime a target shared phonological onset, and the prime was not a cognate---, leaving out *unrelated* trials.

In both analyses, we modelled the probability of target looking across the time course of the trial. For each trial, we chunked the time domain of the target-distractor phase into 20 time bins of 100 ms of duration. We then calculated, for each experimental session, time bin, and condition, the number of eye-tracker samples in which the participant was looking to the target and the distractor pictures. Finally, we computed the empirical logit of target fixations using @eq-elogit [@barr2008analyzing; @agresti2012categorical], which modelled in our analyses using a Gaussian distribution.

$$
\eta' = \ln\bigg(\frac{\text{Target} + 0.5}{ \text{Distractor} + 0.5}\bigg)
$$ {#eq-elogit}


In the first analysis, we included *Relatedness* (`Related` vs. `Unrelated`, sum-coded as `-0.5` and `+0.5`), *Group* (`Monolingual` vs. `Bilingual`, sum-coded as `-0.5` and `+0.5`), and *Age* (participants' standardised age in months) as fixed, main effects, together with their two- and three-way interactions. We used multilevel General Additive Mixed Models (GAMMs) to model the time course of target looking, including cubic regression splines for the main effect of *Time*, and one for an adjustment of the *Time* cubic spline by *Group* and *Relatedness* [@wood2017generalized]. For both splines, we specified $k = 10$ basis functions or *knots*--half the number of time bins---for computational convenience. Finally, we added by-participant random intercepts, and random slopes for the main effect of *Relatedness* and the main effect of *Age*, both including repeated measures per participant [@pedersen2019hierarchical]. In the second analysis, we included *Cognateness* (`Cognate` vs. `Non-cognate`, sum-coded as `-0.5` and `+0.5`) replacing *Relatedness*. @eq-model shows the formal implementation of the model.

To test the contribution of each of the predictors of interest--*Relatedness*/*Cognateness*, and *Group*--, we compared each model ($\mathcal{M_0}$) against a simplified model dropping each of the main effects, *Relatedness*/*Cognateness* ($\mathcal{M}_1$) or *Group* ($\mathcal{M_2}$). In both simplified models, the interaction term was dropped. We used leave-one-out cross-validation (LOO-CV) as a benchmark of model performance, using Pareto-smoothed importance sampling (PSIS) to approximate it. We then examined the posterior predictions of the best-performing model for interpretation.

$$
\begin{aligned}
\textbf{Likelihood:} \\
y_i &\sim \mathcal{N}(\mu_i, \sigma_i) \\ \\
\textbf{Linear model:} \\
\eta'(\mu_i) &= (\beta_0 + u _{0_{i}}) + (\beta_1 + u _{1_{i}}) \cdot \text{[Condition]} +\\
&\beta_{2} \cdot \text{Group} + \beta_{3} \cdot (\text{[Condition]} \times \text{Group}) +\\
& (\beta_4 + u_{2_{i}}) \cdot \text{Age} + \sum_{j = 1}^k b_{j_{1}} \cdot \beta_{5_{k}} \cdot \text{Time} + \sum_{j = 1}^k b_{j_{1}} \cdot\beta_{6_{k}} \cdot (\text{Time} \times \text{Group}) \\
\text{where:} \\
&\eta'\text{ is the empirical logit of target fixations} \\
& \text{[Condition] should be replaced with } Relatedness \text{ or } Cognateness \\
&k \text{ is the number of knots in the spline (10)} \\
\textbf{Prior:} \\
\beta_{0-6} &\sim \mathcal{N}(0, 0.5) \\
u_{0-2} &\sim \mathcal{N}(0, \sigma_{0-2})\\
b_{0-1} &\sim \text{MVN}(0, \tau_{0-1}) \\
\sigma_{0-2}, \tau_{0-1} &\sim \text{Exponential}(6)\\
\rho_{0-2} &\sim LKJCorr(6)\\
\text{where:}\\
&\rho_{0-2} \text{ are the correlation parameters for } \sigma_{0-2}
\end{aligned}
$$ {#eq-model}

# Results

```{r fig-ptlt-descriptive}
#| label: fig-ptlt-descriptive
#| fig-cap: "Average probability of target looking across the time course of the trial. Points an whiskers indicate the mean and standard error of the mean."
data_time |> 
	summarise(.elog = mean(.elog),
			  .by = c(session_id, timebin, lp, condition)) |> 
	ggplot(aes(timebin, .elog, colour = condition, fill = condition)) +
	facet_wrap(~lp) +
	geom_hline(yintercept = 0.5, linetype = "dashed") +
	stat_summary(fun.data = mean_se,
				 geom = "errorbar",
				 width = 0.5) +
	stat_summary(fun = mean,
				 geom = "line") +
	stat_summary(fun = mean,
				 geom = "point") +
	theme(axis.title.x = element_blank()) +
	
	data_time |> 
	summarise(.elog = mean(.elog),
			  .by = c(session_id, timebin, lp, condition)) |> 
	ggplot(aes(timebin, .elog, colour = condition, fill = condition)) +
	facet_wrap(~lp) +
	geom_hline(yintercept = 0.5, linetype = "dashed") +
	stat_summary(fun.data = mean_se,
				 geom = "errorbar",
				 width = 0.5) +
	stat_summary(fun = mean,
				 geom = "line") +
	stat_summary(fun = mean,
				 geom = "point") +
	theme(strip.text = element_blank()) +
	
	plot_layout(ncol = 1) &
	plot_annotation(tag_levels = "A") &
	labs(x = "Time bin (100 ms)",
		 y = "P(Target looking)",
		 colour = "Condition",
		 fill = "Condition") &
	# scale_y_continuous(breaks = seq(0, 1, 0.1)) &
	theme(legend.position = "right",
		  panel.grid.major.x = element_line(colour = "grey",
		  								  linetype = "dotted"),
		  panel.grid.major.y = element_line(colour = "grey",
		  								  linetype = "dotted")) 

```

## Aggregated analysis

In a first analysis, we examined the effect of phonological priming. We compared participants' looking preference for the target in related and unrelated trials. We first compared the aggregated probability of target looking across time bins in both conditions for each language group.  

```{r fig-related-aggregated}
#| label: fig-related-aggregated
#| fig-cap: "A) Aggregated probability of target looking for related and unrelated trials. Each point represents the mean probability of target looking for one participant in one testing session. Lines link observations from the same testing session across conditions. Black dots and errorbars indicate the mean and 95% CrI. B) Aggregated probability of target looking across ages for related and unrelated trials. Lines and error bands indicate the mean and standard error of the mean."
nd <- expand(data_aggr, lp, condition, age = seq(20, 32, length.out = 100))

epreds <- add_epred_draws(newdata = nd,
						  object = model_fits_aggr$fit_aggr_4,
						  re_formula = NA) |> 
	mean_qi() |> 
	mutate(label = sprintf("%.2f\n[%.2f, %.2f]", .epred, .lower, .upper))


epreds |> 
	ggplot(aes(age, .epred, 
			   colour = condition,
			   fill = condition)) +
	facet_wrap(~lp) +
	# geom_line(data = data_related,
	# 		  aes(y = .elog,
	# 		  	group = session_id),
	# 		  colour = "grey",
	# 		  alpha = 1/4) +
	# geom_dots(dat = data_aggr,
	# 		  aes(y = .elog),
	# 		  side = "both",
	# 		  show.legend = FALSE) +
	geom_hline(yintercept = 0,
			   linetype = "dashed") +
	geom_ribbon(aes(ymin = .lower,
					ymax = .upper),
				alpha = 1/3,
				linewidth = NA) +
	geom_line(linewidth = 3/4) +
	geom_point(data = data_aggr,
			   aes(y = .elog),
			   alpha = 1/2) +
	# geom_label(aes(label = label,
	# 			   y = -1.5),
	# 		   fill = "white",
	# 		   colour = "black",
	# 		   label.r = unit(0, "lines"),
	# 		   label.size = 0,
	# 		   vjust = 0,
	# 		   size = 3,
	# 		   alpha = 1/2) +
	labs(x = "Condition",
		 y = "P(Target looking)",
		 colour = "Condition",
		 fill = "Condition") +
	scale_y_continuous(breaks = seq(-4, 4, 0.5)) +
	theme(legend.position = "none",
		  axis.title.x = element_blank(),
		  strip.background = element_rect(fill = "grey90",
		  								colour = "grey90"),
		  panel.grid.major.y = element_line(linetype = "dotted",
		  								  colour = "grey")) 
```

## Time course analysis

```{r fig-time}
#| label: fig-time
#| fig-height: 6
#| fig-width: 8
#| fig-cap: "Marginal posterior predictions of the GAMMs in Analysis 1. (A) Mean posterior probability of target looking across the time course of the trial. Black lines and intervals indicate the psoterior mean and 95% credible intervals. Points indicate the mean probability of target looking across participants. (B) Difference in posterior probability of target looking between *related* and *unrelated* trials. The yellow rectangle indicates, in both A and B, the range of time points in which the 95% credible interval of the differences excluded zero."
plot_gamm <- function(data, model, contrast = "related") {
	
	nd <- expand_grid(condition = levels(data$condition),
					  timebin = seq(0, 17, length.out = 100),
					  age = mean(data$age),
					  # sesion_id = first(data$session_id),
					  # age = c(21, 25, 30),
					  lp = levels(data$lp)) 
	
	epreds <- add_epred_draws(newdata = nd,
							  object = model,
							  # ndraws = NULL,
							  re_formula = NA,
							  value = ".value") |> 
		mutate(lp = factor(lp, 
						   levels = c("Monolingual (English)",
						   		   "Monolingual",
						   		   "Bilingual")),
			   age = factor(age, levels = c(21, 25, 30),
			   			 labels = paste0(c(21, 25, 30), " months")))
	
	epreds_diff <- epreds |> 
		pivot_wider(names_from = condition,
					values_from = .value,
					id_cols = c(timebin, age, lp, .draw),
					names_repair = janitor::make_clean_names) 
	# 
	# if (contrast=="related") {
	# 	epreds_diff$diff <- epreds_diff$related - epreds_diff$unrelated
	# } else {
	# 	epreds_diff$diff <- epreds_diff$cognate - epreds_diff$non_cognate
	# }
	
	obs <- data |> 
		mutate(age = factor(age, levels = c(21, 25, 30),
							labels = paste0(c(21, 25, 30), " months"))) |> 
		summarise(.elog = mean(.elog),
				  .by = c(session_id, timebin, lp, condition, age)) 
	
	epreds |> 
		ggplot(aes(timebin, y = .value,
				   colour = condition,
				   fill = condition,
				   shape = condition)) +
		facet_wrap(~lp) +
		# stat_summary(fun.data = mean_qi,
		# 			 geom = "ribbon",
		# 			 alpha = 0.5,
		# 			 linewidth = 0) +
		stat_summary(aes(linetype = condition),
					 fun = mean,
					 geom = "line",
					 linewidth = 3/4) +
		geom_hline(yintercept = 0, 
				   linewidth = 1/2,
				   colour = "black",
				   linetype = "dotted") +
		stat_summary(data = obs,
					 aes(y = .elog),
					 fun.data = "mean_se",
					 geom = "errorbar",
					 width = 1,
					 linewidth = 3/4,
					 position = position_dodge(width = 0.5)) +
		stat_summary(data = obs,
					 aes(y = .elog),
					 fun = "mean",
					 geom = "point",
					 size = 2,
					 position = position_dodge(width = 0.5)) +
		# stat_summary(fun.data = mean_se,
		# 			 geom = "errorbar",
		# 			 linetype = "solid",
		# 			 width = 0.25) +
		# stat_summary(fun = mean,
		# 			 geom = "point") +
		labs(x = "Time (ms)",
			 y = "P(Target looking)",
			 colour = "Condition",
			 fill = "Condition",
			 linetype = "Condition",
			 shape = "Condition") +
		theme(legend.title = element_blank(),
			  legend.position = "top",
			  axis.title.x = element_blank()) 
	
	epreds_diff |> 
		ggplot(aes(timebin, diff)) +
		facet_wrap(~lp) +
		stat_lineribbon(.width = 0.95,
						linewidth = 0,
						fill = "grey") +
		stat_summary(data = epreds_diff,
					 fun = "mean",
					 geom = "line",
					 colour = "black",
					 linewidth = 3/4) +
		geom_hline(yintercept = 0, 
				   linewidth = 1/2,
				   colour = "black",
				   linetype = "dotted") +
		labs(x = "Time (ms)",
			 y = "Related - Unrelated",
			 fill = "CrI") +
		theme(strip.text = element_blank(),
			  legend.position = "none") +
		
		plot_layout(ncol = 1) &
		plot_annotation(tag_levels = "A") +
		scale_linetype_manual(values = rev(c("solid", "dashed"))) &
		# scale_shape_manual(values = c(1, 2)) &
		scale_x_continuous(labels = \(x) format((x * 1e2), 
												big.mark = ",")) &
		theme(panel.grid = element_blank(),
			  legend.position = "top") 
}

plot_gamm(data_time_related, 
		  model_fits_related[[1]],
		  contrast = "related")

```



{{< pagebreak >}}



# Discussion

## Summary

## Context

## Facilitation vs. inhibition

## Onsets vs. offsets

## Problems and generalisatility

## Future steps

## Conclusions

# References


{{< pagebreak >}}

# Appendix

## Appendix A: imputing voabulary size scores

```{r fig-vocabulary-imputation}
vocabulary_tmp <- vocabulary |> 
	left_join(select(participants, child_id, vocab_id, age),
			  by = join_by(child_id, vocab_id)) |> 
	relocate(child_id) |> 
	filter(is_imputed)

bvq_data$vocabulary |> 
	inner_join(distinct(bvq_data$logs, child_id, response_id, lp, age),
			   by = join_by(response_id)) |> 
	mutate(is_imputed = FALSE) |> 
	bind_rows(vocabulary_tmp) |> 
	pivot_longer(ends_with("_prop"),
				 names_to = "measure",
				 values_to = "prop") |> 
	drop_na(prop) |> 
	mutate(is_imputed = ifelse(is_imputed, "Imputed", "Observed"),
		   measure = factor(measure,
		   				 levels = c("total_prop",
		   				 		   "l1_prop",
		   				 		   "l2_prop",
		   				 		   "concept_prop",
		   				 		   "te_prop"),
		   				 labels = c("Total",
		   				 		   "L1",
		   				 		   "L2",
		   				 		   "Conceptual",
		   				 		   "TE"))) |> 
	ggplot(aes(age, prop, 
			   colour = is_imputed,
			   fill = is_imputed)) +
	facet_wrap(~measure) +
	geom_point(alpha = 1/4, size = 1) +
	geom_smooth(method = "glm", 
				formula = "y ~ x",
				method.args = list(family = "binomial"), 
				# se = FALSE,
				size = 1) +
	labs(x = "Age (months)",
		 y = "Vocabulary size",
		 fill = "Imputed",
		 colour = "Imputed") +
	theme(legend.position = c(1, 0),
		  legend.justification = c(1, 0),
		  legend.title = element_blank())

```

{{< pagebreak >}}


## Appendix B: distribution of prime and target looking times

```{r fig-dist-prime}
#| label: fig-dist-prime
#| fig-height: 4
#| fig-width: 8
looking_times |> 
	mutate(prime_time = cut(prime_time, 
							seq(0, 1.5, 0.1),
							labels = FALSE,
							include.lowest = TRUE)) |> 
	add_count(lp, age_group, name = "n_total") |> 
	count(lp, age_group, prime_time, n_total) |> 
	mutate(n = n / n_total) |> 
	ggplot(aes(prime_time, n)) +
	facet_grid(lp~age_group) +
	annotate(geom = "rect",
			 fill = "orange",
			 ymin = -Inf,
			 ymax = Inf,
			 xmin = 0,
			 xmax = 0.75*10,
			 alpha = 1/3,
			 colour = NA) +
	# annotate(label = "Excluded trials",
	# 		 geom = "text",
	# 		  x = (0.75/2)*10,
	# 		  y = 1)
	geom_col(fill = "black") +
	labs(x = "Prime looking time (s)",
		 y = "Proportion of trials") +
	scale_x_continuous(labels = \(x) x/10) +
	theme(panel.grid.major.y = element_line(linetype = "dotted",
											colour = "grey"))
```

```{r fig-dist-target}
#| label: fig-dist-target
#| fig-height: 4
#| fig-width: 8
looking_times |> 
	mutate(target_time = cut(target_time, 
							 seq(0, 2, 0.1),
							 labels = FALSE,
							 include.lowest = TRUE)) |> 
	add_count(lp, age_group, name = "n_total") |> 
	count(lp, age_group, target_time, n_total) |> 
	mutate(n = n / n_total) |> 
	ggplot(aes(target_time, n)) +
	facet_grid(lp~age_group) +
	# annotate(label = "Excluded trials",
	# 		 geom = "text",
	# 		  x = (0.75/2)*10,
	# 		  y = 1)
	geom_col(fill = "black") +
	labs(x = "Targets looking time (s)",
		 y = "Proportion of trials") +
	scale_x_continuous(labels = \(x) x/10) +
	theme(panel.grid.major.y = element_line(linetype = "dotted",
											colour = "grey"))
```

{{< pagebreak >}}

## Appendix C: prime and test looking times

```{r fig-looking-times}
#| label: fig-looking-times
#| fig-height: 8
#| fig-width: 8
#| fig-cap: "Looking time (s) to the prime and target AOI against audio duration. In longer audios, participants are expected to look longer to the prime and target picture."

looking_times |>
	left_join(select(attrition_trials, 
					 filename, trial, is_valid_trial),
			  by = join_by(filename, trial)) |>
	filter(is_valid_trial) |> 
	ggplot(aes(duration,
			   prime_time,
			   colour = trial_type, 
			   fill = trial_type,
			   shape = trial_type)) +
	facet_grid(lp~age_group) +
	geom_point(alpha = 0.5, 
			   size = 1) +
	geom_smooth(method = "lm") +
	theme(axis.title.x = element_blank()) +
	
	looking_times |>
	left_join(select(attrition_trials, 
					 filename, trial, is_valid_trial),
			  by = join_by(filename, trial)) |>
	filter(is_valid_trial) |> 
	ggplot(aes(duration,
			   target_time,
			   colour = trial_type, 
			   fill = trial_type,
			   shape = trial_type)) +
	facet_grid(lp~age_group) +
	geom_point(alpha = 0.5,
			   size = 1) +
	geom_smooth(method = "lm",
				formula = "y ~ x") +
	plot_layout(ncol = 1, guides = "collect") &
	plot_annotation(tag_levels = "A") &
	labs(x = "Audio duration (s)",
		 y = "Looking time (1.0-2.0 seconds)",
		 colour = "Prime type",
		 fill = "Prime type",
		 shape = "Prime type") 
```


## Appendix D: vocabulary checklist validity

```{r fig-validity-target}
get_data(gaze = gaze,
		 participants = participants,
		 stimuli = stimuli,
		 vocabulary = vocabulary,
		 attrition_trials = attrition_trials,
		 attrition_participants = attrition_participants,
		 time_subset = c(0, 2),
		 contrast = "related",
		 is_valid_vocab_all,
		 clean = FALSE) |> 
	unnest_wider(is_valid_vocab_all) |>
	select(session_id, lp, .elog, target) |> 
	arrange(session_id, target) |> 
	summarise(.elog_mean = mean(.elog),
			  .elog_sd = sd(.elog),
			  n = n(),
			  .by = c(lp, target)) |> 
	mutate(target = ifelse(target, "Yes", "No"),
		   .elog_se = .elog_sd/sqrt(n),
		   .elog_lower = .elog_mean - .elog_se*1.96,
		   .elog_upper = .elog_mean + .elog_se*1.96,
	) |> 
	ggplot(aes(lp, .elog_mean, 
			   ymin = .elog_lower,
			   ymax = .elog_upper,
			   colour = target)) +
	facet_wrap(~lp, ncol = 1, scales = "free_x") +
	geom_errorbar(width = 0.2, linewidth = 3/4, 
				  position = position_dodge(width = 0.25)) +
	geom_point(size = 2,
			   position = position_dodge(width = 0.25)) +
	geom_hline(yintercept = 0,
			   linetype = "dashed") +
	labs(x = "Condition",
		 y = "P(Target looking)", 
		 colour = "Knows the target word") +
	theme(legend.position = "none",
		  panel.grid.major.y = element_line(colour = "grey",
		  								  linetype = "dotted")) +
	
	get_data_time(gaze = gaze,
				  participants = participants,
				  stimuli = stimuli,
				  vocabulary = vocabulary,
				  attrition_trials = attrition_trials,
				  attrition_participants = attrition_participants,
				  time_subset = c(0, 2),
				  contrast = "related",
				  is_valid_vocab_all,
				  clean = FALSE) |> 
	unnest_wider(is_valid_vocab_all) |>
	select(session_id, age, lp, timebin, .elog, target) |> 
	arrange(session_id, target) |> 
	summarise(.elog_mean = mean(.elog),
			  .elog_sd = sd(.elog),
			  n = n(),
			  .by = c(timebin, lp, target)) |> 
	mutate(target = ifelse(target, "Yes", "No"),
		   .elog_se = .elog_sd/sqrt(n),
		   .elog_lower = .elog_mean - .elog_se*1.96,
		   .elog_upper = .elog_mean + .elog_se*1.96,
	) |> 
	ggplot(aes(timebin, .elog_mean,
			   ymin = .elog_lower,
			   ymax = .elog_upper,
			   colour = target,
			   fill = target)) +
	facet_wrap(~lp, ncol = 1, scales = "free_x") +
	geom_line(linewidth = 1/2) +
	geom_ribbon(alpha = 1/2,
				colour = NA) +
	geom_point(size = 2) +
	geom_hline(yintercept = 0,
			   linetype = "dashed") +
	labs(x = "Condition",
		 y = "P(Target looking)", 
		 fill = "Knows the target word",
		 colour = "Knows the target word") +
	theme(legend.position = "top",
		  panel.grid.major.y = element_line(colour = "grey",
		  								  linetype = "dotted"),
		  axis.title.y = element_blank(),
		  axis.line.x = element_line()) +
	
	plot_layout(ncol = 2,
				widths = c(0.2, 0.8)) &
	scale_y_continuous(limits = c(-0.5, 1.25))
```

