---
title: "Report"
output:
  html_document:
    df_print: paged
    toc: true
    toc_depth: 5
    toc_float: true
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = TRUE,
	warning = TRUE, 
	cache.extra = knitr::rand_seed,
	out.width = "100%",
	results = "asis",
	dev.args = list(png = list(type = "cairo"))
)
options(knitr.kable.NA = '-',
		ggplot2.discrete.fill = ggsci::pal_tron("legacy")(7),
		ggplot2.discrete.colour = ggsci::pal_tron("legacy")(7)
)

```


```{r params, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

# load packages
library(targets)
library(papaja)
library(knitr)
library(tidyverse)
library(lubridate)
library(scales)
library(DiagrammeR)
library(janitor)
library(lme4)
library(broom.mixed)
library(gt)
library(patchwork)
library(htmltools)
library(wesanderson)
library(shiny)
library(tidytext)
library(here)

# load objects
tar_load(participants)
tar_load(stimuli)
tar_load(vocabulary)
tar_load(gaze)
tar_load(gaze_relaxed)
tar_load(attrition)
tar_load(attrition_relaxed)
tar_load(attrition_counter)
tar_load(attrition_relaxed_counter)
tar_load(model_fits)
tar_load(model_fits_relaxed)

theme_set(theme_custom()) # in utils.R
```


```{r prepare, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

attrition <- attrition %>% 
	mutate(
		valid_gaze = valid_gaze_prime & valid_gaze_target,
		valid_status = case_when(
			!valid_vocab ~ "Invalid vocabulary",
			!valid_gaze ~ "Invalid gaze",
			!valid_participant ~ "Invalid participant",
			TRUE ~ "Valid"
		))

attrition_relaxed <- attrition_relaxed %>% 
	mutate(
		valid_gaze = valid_gaze_prime & valid_gaze_target,
		valid_status = case_when(
			!valid_vocab ~ "Invalid vocabulary",
			!valid_gaze ~ "Invalid gaze",
			!valid_participant ~ "Invalid participant",
			TRUE ~ "Valid"
		))

attrition_counter <- attrition_counter %>% 
	mutate(
		valid_gaze = valid_gaze_prime & valid_gaze_target,
		valid_status = case_when(
			!valid_vocab ~ "Invalid vocabulary",
			!valid_gaze ~ "Invalid gaze",
			!valid_participant ~ "Invalid participant",
			!valid_counter ~ "Invalid counter",
			TRUE ~ "Valid"
		))

attrition_relaxed_counter <- attrition_relaxed_counter %>% 
	mutate(
		valid_gaze = valid_gaze_prime & valid_gaze_target,
		valid_status = case_when(
			!valid_vocab ~ "Invalid vocabulary",
			!valid_gaze ~ "Invalid gaze",
			!valid_participant ~ "Invalid participant",
			!valid_counter ~ "Invalid counter",
			TRUE ~ "Valid"
		))

participants_stringent <- participants %>% 
	left_join(distinct(attrition, participant, age_group, valid_participant)) %>% 
	drop_na(participant) %>% 
	left_join(vocabulary) %>% 
	mutate(vocab_size_l1_center = scale(vocab_size_l1)[,1])

participants_relaxed <- participants %>% 
	left_join(distinct(attrition_relaxed, participant, age_group, valid_participant)) %>% 
	drop_na(participant) %>% 
	left_join(vocabulary) %>% 
	mutate(vocab_size_l1_center = scale(vocab_size_l1)[,1])

participants_counter <- participants %>% 
	left_join(distinct(attrition_counter, participant, age_group, valid_participant)) %>% 
	drop_na(participant) %>% 
	left_join(vocabulary) %>% 
	mutate(vocab_size_l1_center = scale(vocab_size_l1)[,1])

participants_relaxed_counter <- participants %>% 
	left_join(distinct(attrition_relaxed_counter, participant, age_group, valid_participant)) %>% 
	drop_na(participant) %>% 
	left_join(vocabulary) %>% 
	mutate(vocab_size_l1_center = scale(vocab_size_l1)[,1])

```


# Methods

## Participants {.tabset .tabset-pills}

### Stringent criteria {.tabset}

```{r child="report_00_participants_stringent.Rmd"}
```


### Relaxed criteria {.tabset}


```{r child="report_00_participants_relaxed.Rmd"}
```


## Stimuli

```{r child="report_01_stimuli.Rmd"}
```


## Procedure


```{r child="report_02_procedure.Rmd"}
```


## Data analysis


```{r child="report_03_data-analysis.Rmd"}
```


### {-}


## {-}


# Results {.tabset .tabset-pills}

## Gaze {.tabset .tabset-pills}

### Stringent criteria {.tabset}

```{r child="report_04_gca_stringent.Rmd"}
```

### Relaxed criteria {.tabset}

```{r child="report_04_gca_relaxed.Rmd"}
```

### {-}


## Attrition {.tabset}

### Stringent criteria {.tabset}

```{r child="report_05_attrition_stringent.Rmd"}
```

### Relaxed criteria {.tabset}

```{r child="report_05_attrition_relaxed.Rmd"}
```

### Counterbalancing {.tabset}

#### Stringent criteria {.tabset}

```{r child="report_05_attrition_counter_stringent.Rmd"}
```

#### Relaxed criteria {.tabset}

```{r child="report_05_attrition_counter_relaxed.Rmd"}
```


#### {-}

### {-}


## 21 months-old monolinguals {.tabset}

### Stringent criteria {.tabset}

```{r child="report_06_21-mon_stringent.Rmd"}
```

### Relaxed criteria {.tabset}

```{r child="report_06_21-mon_relaxed.Rmd"}
```

### {-}

## 21 and 25 months-old monolinguals {.tabset}


### Stringent criteria {.tabset}


```{r child="report_07_2125-mon_stringent.Rmd"}
```


### Relaxed criteria {.tabset}



```{r child="report_07_2125-mon_relaxed.Rmd"}
```

### {-}


## 21, 25, and 30 months-old monolinguals {.tabset}


### Stringent criteria {.tabset}


```{r child="report_08_mon_stringent.Rmd"}
```


### Relax

```{r child="report_08_mon_relaxed.Rmd"}
```



### {-}


## Vocabulary {.tabset .tabset-pills}


### Stringent criteria {.tabset}


```{r child="report_09_vocabulary_stringent.Rmd"}
```


### Relaxed criteria {.tabset}

```{r child="report_09_vocabulary_relaxed.Rmd"}
```


### {-}


## {-}


# Appendix


# References

